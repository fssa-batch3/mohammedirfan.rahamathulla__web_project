<!DOCTYPE html>

<head lan="eng">
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>SIGN UP</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href="../../assets/css/signup.css">
    <script src="https://cdn.jsdelivr.net/npm/uuid@8.3.2/dist/umd/uuidv4.min.js"></script>

</head>

<body>


    <div class="main">
<form role="form" onsubmit="signUp(event)" >
        <h1>BOOK IRFU TICKETS</h1>

        <div class="input">
            <h2>SIGN UP</h2>

            <div class="email">
                <input required type="text" placeholder="Enter your name" required="email" id="name"  pattern="[a-zA-Z]+" title="Enter alphabet without space" required="true" />
                <label>NAME </label>
            </div>

            <div class="email">
                <input required type="number" placeholder="Enter your phone number" id="phone_number" />
                <label>NUMBER</label>
            </div>

            <div class="email">
                <input required type="email" placeholder="Enter your email" id="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required="true"/>
                <label>EMAIL</label>
            </div>

            <div class="email">
                <input required type="password" placeholder="Enter your password" id="password"pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8}" title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters" required="true" />
                <label>PASSWORD</label>
            </div>
            <div class="email">
                <input required type="password" placeholder="Confirm your password" id="con_password"required="true" />
                <label>CONFIRM </label>
            </div>

            <button type="submit">SUBMIT</button>

        </div>
    </form >
    </div>
 
    <script>
        const signUp = e => {
            e.preventDefault();
    let name = document.getElementById("name").value
    let email = document.getElementById("email").value
    let phone_number = document.getElementById("phone_number").value
    let password = document.getElementById("password").value
    let con_password = document.getElementById("con_password").value
    let my_uuid = uuidv4();
    
    let userData = JSON.parse(localStorage.getItem("userData")) || [];
    let exist = userData.length &&
    
        JSON.parse(localStorage.getItem("userData")).some(data =>
            data.phone_number.toLowerCase() == phone_number.toLowerCase() ||
            data.email.toLowerCase() == email.toLowerCase()
            );
            if(!exist){
                if(password == con_password){
                    // push into objects
                    userData.push({"name":name, "email":email, "phone_number": phone_number,"password": password,"my_uuid":my_uuid});
                    // store data into local storage
                    localStorage.setItem("userData", JSON.stringify(userData));
                    // after store data, reset form
                    document.querySelector("form").reset();
                    document.getElementById("phone_number").focus();
                    document.getElementById('email').focus();
                    alert("Register Sucessfull :white_check_mark:");
                    location.href="../../pages/other pages/signin.html";
                }
                else{
                    alert("Incorrect Passowrd :x:")
                }
            }
            else{
                alert("Sorry the User already Exist!! \n Try with different Phone number or email");
                document.querySelector("form").reset();
            }
         
}
    </script>

</body>
